<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACME Rentals - Premium Properties & Luxury Living</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <style>
        /* CSS Variables */
        :root {
            /* ACME Rentals Brand Colors */
            --primary: #1B365D;           /* Deep Navy Blue */
            --primary-light: #2E4F73;     /* Lighter Navy */
            --secondary: #C69C6C;         /* Gold Accent */
            --secondary-light: #E8D5B7;   /* Light Gold */
            --accent: #E74C3C;            /* Red CTA */
            --accent-hover: #C0392B;      /* Red Hover */
            
            /* Neutral Colors */
            --white: #FFFFFF;
            --gray-50: #F8F9FA;
            --gray-100: #F1F3F5;
            --gray-200: #E9ECEF;
            --gray-300: #DEE2E6;
            --gray-400: #CED4DA;
            --gray-500: #ADB5BD;
            --gray-600: #6C757D;
            --gray-700: #495057;
            --gray-800: #343A40;
            --gray-900: #212529;
            
            /* Typography */
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 2rem;
            --font-size-4xl: 2.5rem;
            --font-size-5xl: 3rem;
            --font-size-6xl: 4rem;
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --space-3xl: 64px;
            --space-4xl: 96px;
            
            /* Border Radius */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 24px;
            
            /* Shadows */
            --shadow-sm: 0 2px 4px rgba(27, 54, 93, 0.08);
            --shadow-md: 0 4px 12px rgba(27, 54, 93, 0.12);
            --shadow-lg: 0 10px 25px rgba(27, 54, 93, 0.15);
            --shadow-xl: 0 20px 40px rgba(27, 54, 93, 0.2);
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-spring: 500ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
            
            /* Z-index */
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-fixed: 1030;
            --z-modal-backdrop: 1040;
            --z-modal: 1050;
            --z-demo-menu: 2000;
        }
        
        /* Reset & Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            scroll-behavior: smooth;
        }
        
        body {
            font-family: var(--font-primary);
            font-size: var(--font-size-base);
            line-height: 1.6;
            color: var(--gray-800);
            background: var(--white);
            overflow-x: hidden;
        }
        
        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            letter-spacing: -0.025em;
            color: var(--gray-900);
        }
        
        h1 { font-size: var(--font-size-5xl); }
        h2 { font-size: var(--font-size-4xl); }
        h3 { font-size: var(--font-size-3xl); }
        h4 { font-size: var(--font-size-2xl); }
        h5 { font-size: var(--font-size-xl); }
        h6 { font-size: var(--font-size-lg); }
        
        p {
            line-height: 1.7;
            color: var(--gray-600);
        }
        
        /* Utility Classes */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-lg);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: var(--font-size-base);
            text-decoration: none;
            cursor: pointer;
            transition: all var(--transition-base);
            border: none;
            outline: none;
            position: relative;
            overflow: hidden;
            letter-spacing: -0.01em;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }
        
        .btn:active::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(27, 54, 93, 0.3);
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(27, 54, 93, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-2px);
        }
        
        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--gray-200);
            z-index: var(--z-sticky);
            transition: all var(--transition-base);
        }
        
        .header.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: var(--shadow-md);
        }
        
        .nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 80px;
        }
        
        .logo {
            font-size: var(--font-size-2xl);
            font-weight: 800;
            color: var(--primary);
            text-decoration: none;
            letter-spacing: -0.02em;
        }
        
        .nav-links {
            display: flex;
            align-items: center;
            gap: var(--space-xl);
            list-style: none;
        }
        
        .nav-link {
            color: var(--gray-700);
            text-decoration: none;
            font-weight: 500;
            transition: color var(--transition-base);
            position: relative;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--secondary);
            transition: width var(--transition-base);
        }
        
        .nav-link:hover {
            color: var(--primary);
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        /* Hero Section */
        .hero {
            padding: 120px 0 var(--space-4xl);
            background: linear-gradient(135deg, 
                rgba(27, 54, 93, 0.05) 0%, 
                rgba(198, 156, 108, 0.05) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23C69C6C" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            z-index: 1;
        }
        
        .hero-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4xl);
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .hero-text h1 {
            font-size: var(--font-size-6xl);
            margin-bottom: var(--space-lg);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-text p {
            font-size: var(--font-size-xl);
            margin-bottom: var(--space-2xl);
            color: var(--gray-600);
        }
        
        .hero-actions {
            display: flex;
            gap: var(--space-lg);
            flex-wrap: wrap;
        }
        
        .hero-image {
            position: relative;
        }
        
        .hero-image::before {
            content: '';
            position: absolute;
            top: -20px;
            left: -20px;
            right: 20px;
            bottom: 20px;
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            border-radius: var(--radius-2xl);
            z-index: -1;
        }
        
        .hero-image img {
            width: 100%;
            height: 500px;
            object-fit: cover;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
        }
        
        /* Features Section */
        .features {
            padding: var(--space-4xl) 0;
            background: var(--white);
        }
        
        .section-header {
            text-align: center;
            margin-bottom: var(--space-4xl);
        }
        
        .section-title {
            font-size: var(--font-size-4xl);
            margin-bottom: var(--space-lg);
            color: var(--primary);
        }
        
        .section-subtitle {
            font-size: var(--font-size-xl);
            color: var(--gray-600);
            max-width: 600px;
            margin: 0 auto;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-2xl);
        }
        
        .feature-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-2xl);
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
            border: 1px solid var(--gray-200);
        }
        
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--secondary);
        }
        
        .feature-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--space-lg);
        }
        
        .feature-icon .material-symbols-outlined {
            font-size: 32px;
            color: var(--white);
        }
        
        .feature-title {
            font-size: var(--font-size-xl);
            margin-bottom: var(--space-md);
            color: var(--primary);
        }
        
        .feature-description {
            color: var(--gray-600);
            line-height: 1.7;
        }
        
        /* Properties Section */
        .properties {
            padding: var(--space-4xl) 0;
            background: var(--gray-50);
        }
        
        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--space-2xl);
        }
        
        .property-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
        }
        
        .property-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }
        
        .property-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        
        .property-content {
            padding: var(--space-xl);
        }
        
        .property-price {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--accent);
            margin-bottom: var(--space-sm);
        }
        
        .property-title {
            font-size: var(--font-size-xl);
            margin-bottom: var(--space-md);
            color: var(--primary);
        }
        
        .property-details {
            display: flex;
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
            color: var(--gray-600);
        }
        
        .property-detail {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        /* CTA Section */
        .cta {
            padding: var(--space-4xl) 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            text-align: center;
        }
        
        .cta h2 {
            color: var(--white);
            margin-bottom: var(--space-lg);
        }
        
        .cta p {
            color: rgba(255, 255, 255, 0.9);
            font-size: var(--font-size-xl);
            margin-bottom: var(--space-2xl);
        }
        
        /* Footer */
        .footer {
            padding: var(--space-4xl) 0 var(--space-2xl);
            background: var(--gray-900);
            color: var(--gray-300);
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-2xl);
            margin-bottom: var(--space-2xl);
        }
        
        .footer-section h4 {
            color: var(--white);
            margin-bottom: var(--space-lg);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: var(--space-sm);
        }
        
        .footer-links a {
            color: var(--gray-400);
            text-decoration: none;
            transition: color var(--transition-base);
        }
        
        .footer-links a:hover {
            color: var(--secondary);
        }
        
        .footer-bottom {
            border-top: 1px solid var(--gray-700);
            padding-top: var(--space-xl);
            text-align: center;
            color: var(--gray-500);
        }
        
        /* Demo Menu Overlay */
        .demo-menu {
            position: fixed;
            top: var(--space-lg);
            right: var(--space-lg);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--gray-200);
            z-index: var(--z-demo-menu);
            min-width: 280px;
            transition: all var(--transition-base);
        }
        
        .demo-menu.collapsed {
            width: 60px;
            min-width: 60px;
            padding: var(--space-md);
        }
        
        .demo-menu.collapsed .demo-menu-content {
            display: none;
        }
        
        .demo-menu-toggle {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-base);
            font-size: 16px;
            z-index: 1;
        }
        
        .demo-menu-toggle:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }
        
        .demo-menu.collapsed .demo-menu-toggle {
            position: static;
            margin: 0 auto;
        }
        
        .demo-menu-header {
            text-align: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .demo-menu-title {
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--space-xs);
        }
        
        .demo-menu-subtitle {
            font-size: var(--font-size-sm);
            color: var(--gray-600);
        }
        
        .demo-menu-options {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .demo-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-base);
            border: 2px solid transparent;
        }
        
        .demo-option:hover {
            background: var(--gray-50);
            border-color: var(--secondary);
        }
        
        .demo-option.active {
            background: linear-gradient(135deg, rgba(198, 156, 108, 0.1) 0%, rgba(198, 156, 108, 0.05) 100%);
            border-color: var(--secondary);
        }
        
        .demo-option-info {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .demo-option-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
        }
        
        .demo-option.active .demo-option-icon {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
        }
        
        .demo-option-text {
            flex: 1;
        }
        
        .demo-option-title {
            font-weight: 600;
            color: var(--gray-800);
            font-size: var(--font-size-sm);
        }
        
        .demo-option-desc {
            font-size: var(--font-size-xs);
            color: var(--gray-600);
        }
        
        .demo-option-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--gray-300);
            transition: all var(--transition-base);
        }
        
        .demo-option.active .demo-option-status {
            background: var(--secondary);
            box-shadow: 0 0 0 3px rgba(198, 156, 108, 0.3);
        }
        
        /* Demo Mode Toggle */
        .demo-mode-toggle {
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--gray-200);
        }
        
        .demo-mode-title {
            font-size: var(--font-size-sm);
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: var(--space-md);
            text-align: center;
        }
        
        .demo-toggle-switch {
            position: relative;
        }
        
        .toggle-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
            font-size: var(--font-size-xs);
            color: var(--gray-600);
        }
        
        .toggle-slider {
            position: relative;
            width: 48px;
            height: 24px;
            background: var(--gray-300);
            border-radius: 12px;
            transition: all var(--transition-base);
            flex-shrink: 0;
            margin: 0 var(--space-sm);
        }
        
        .toggle-slider::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: var(--white);
            border-radius: 50%;
            transition: all var(--transition-base);
            box-shadow: var(--shadow-sm);
        }
        
        #conversationalToggle {
            display: none;
        }
        
        #conversationalToggle:checked + .toggle-label .toggle-slider {
            background: var(--secondary);
        }
        
        #conversationalToggle:checked + .toggle-label .toggle-slider::before {
            transform: translateX(24px);
        }
        
        #conversationalToggle:checked + .toggle-label .toggle-text-on {
            color: var(--secondary);
            font-weight: 600;
        }
        
        #conversationalToggle:not(:checked) + .toggle-label .toggle-text-off {
            color: var(--gray-800);
            font-weight: 600;
        }
        
        /* Lead Magnet Widgets */
        
        /* Popup Form */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-base);
        }
        
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .popup-form {
            background: var(--white);
            border-radius: var(--radius-2xl);
            padding: var(--space-2xl);
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow-xl);
            transform: scale(0.9);
            transition: transform var(--transition-spring);
        }
        
        .popup-overlay.active .popup-form {
            transform: scale(1);
        }
        
        /* Slide-in Panel */
        .slide-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: calc(var(--z-modal) - 1);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-base);
        }
        
        .slide-backdrop.active {
            opacity: 1;
            visibility: visible;
        }
        
        .slide-panel {
            position: fixed;
            top: 0;
            right: -50vw;
            width: 50vw;
            min-width: 400px;
            height: 100vh;
            background: var(--white);
            border-radius: 0;
            padding: 0;
            box-shadow: var(--shadow-xl);
            z-index: var(--z-modal);
            transition: right var(--transition-spring);
        }
        
        .slide-panel.active {
            right: 0;
        }
        
        /* Embedded Form */
        .embedded-form {
            background: linear-gradient(135deg, rgba(27, 54, 93, 0.05) 0%, rgba(198, 156, 108, 0.05) 100%);
            border-radius: var(--radius-2xl);
            padding: var(--space-2xl);
            margin: var(--space-2xl) 0;
            border: 2px solid var(--secondary);
            opacity: 0;
            transform: translateY(20px);
            transition: all var(--transition-slow);
        }
        
        .embedded-form.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Floating Button - Modern Design */
        .floating-button {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(27, 54, 93, 0.4);
            z-index: 9999;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            transform: scale(0.8);
            color: white;
            font-size: 28px;
        }
        
        .floating-button.active {
            opacity: 1;
            transform: scale(1);
        }
        
        .floating-button.pulse {
            animation: floating-pulse 2s infinite;
        }
        
        .floating-button:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 12px 40px rgba(27, 54, 93, 0.5);
            animation: none;
        }
        
        .floating-button .material-symbols-outlined {
            color: white;
            font-size: 28px;
        }
        
        @keyframes floating-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .floating-tooltip {
            position: absolute;
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            background: var(--gray-900);
            color: var(--white);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            white-space: nowrap;
            margin-right: var(--space-md);
            opacity: 0;
            pointer-events: none;
            transition: all var(--transition-base);
        }
        
        .floating-tooltip::after {
            content: '';
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            border: 6px solid transparent;
            border-left-color: var(--gray-900);
        }
        
        .floating-button:hover .floating-tooltip {
            opacity: 1;
        }
        
        /* Form Styles */
        .lead-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }
        
        .form-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }
        
        .form-title {
            font-size: var(--font-size-2xl);
            color: var(--primary);
            margin-bottom: var(--space-sm);
        }
        
        .form-subtitle {
            color: var(--gray-600);
            font-size: var(--font-size-base);
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .form-label {
            font-weight: 600;
            color: var(--gray-800);
            font-size: var(--font-size-sm);
        }
        
        .form-input {
            padding: var(--space-md);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: var(--font-size-base);
            transition: all var(--transition-base);
            background: var(--white);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(198, 156, 108, 0.1);
        }
        
        .form-submit {
            padding: var(--space-lg);
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
            color: var(--white);
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }
        
        .form-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
        }
        
        .form-close {
            position: absolute;
            top: var(--space-lg);
            right: var(--space-lg);
            background: none;
            border: none;
            color: var(--gray-500);
            cursor: pointer;
            padding: var(--space-sm);
            border-radius: var(--radius-md);
            transition: all var(--transition-base);
        }
        
        .form-close:hover {
            background: var(--gray-100);
            color: var(--gray-700);
        }
        
        /* Enhanced Text-Message Conversational Interface */
        .conversational-widget-container {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .chat-widget {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid rgba(255, 255, 255, 0.8);
            border-radius: 24px;
            box-shadow: 
                0 20px 60px rgba(27, 54, 93, 0.15),
                0 8px 25px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100%;
            max-height: 600px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            position: relative;
        }
        
        .chat-widget::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.8) 50%, transparent 100%);
            z-index: 1;
        }
        
        .chat-widget.popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 600px;
            max-width: 90vw;
            height: 700px;
            max-height: 85vh;
            z-index: 10000;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        /* Floating Widget Specific Styles */
        .floating-widget-container {
            position: fixed;
            bottom: 100px;
            right: 24px;
            width: 380px;
            height: 600px;
            z-index: 9999;
            pointer-events: none;
        }
        
        .floating-widget-container .chat-widget {
            position: static !important;
            width: 100% !important;
            height: 100% !important;
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: all;
        }
        
        .floating-widget-container .chat-widget.active {
            transform: translateY(0);
            opacity: 1;
        }
        
        .chat-widget.slide {
            position: fixed;
            top: 0;
            right: -50vw;
            width: 50vw;
            min-width: 400px;
            height: 100vh;
            transform: none;
            transition: right 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10000;
            border-radius: 0;
        }
        
        .chat-widget.slide.active {
            right: 0;
        }
        
        .chat-widget.embedded {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 650px;
            margin: 0 auto;
        }
        
        .chat-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 70%, var(--primary) 100%);
            color: white;
            padding: 20px 24px;
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
            overflow: hidden;
        }
        
        .chat-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 50%, rgba(255, 255, 255, 0.1) 100%);
            pointer-events: none;
        }
        
        .chat-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.4) 50%, transparent 100%);
            animation: headerShine 3s infinite;
        }
        
        @keyframes headerShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .agent-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 2;
        }
        
        .agent-info h4 {
            margin: 0;
            font-size: 17px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
            color: #ffffff;
        }
        
        .agent-info p {
            margin: 4px 0 0;
            font-size: 13px;
            opacity: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
            color: rgba(255, 255, 255, 0.95);
        }
        
        .chat-status {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            opacity: 0.95;
            position: relative;
            z-index: 2;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4ade80;
            box-shadow: 
                0 0 0 2px rgba(74, 222, 128, 0.3),
                0 0 10px rgba(74, 222, 128, 0.5);
            animation: statusPulse 2s infinite;
        }
        
        @keyframes statusPulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.3), 0 0 10px rgba(74, 222, 128, 0.5);
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.1);
                box-shadow: 0 0 0 4px rgba(74, 222, 128, 0.2), 0 0 15px rgba(74, 222, 128, 0.7);
            }
        }
        
        .chat-messages {
            padding: 24px;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: 
                radial-gradient(circle at top left, rgba(248, 250, 252, 0.8) 0%, transparent 50%),
                radial-gradient(circle at bottom right, rgba(241, 245, 249, 0.8) 0%, transparent 50%),
                linear-gradient(145deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 300px;
            max-height: 400px;
            position: relative;
        }
        
        .chat-messages::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(180deg, rgba(248, 250, 252, 0.8) 0%, transparent 100%);
            pointer-events: none;
            z-index: 1;
        }
        
        .message {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            max-width: 85%;
            animation: messageSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            z-index: 2;
        }
        
        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.8);
        }
        
        .message.agent .message-avatar {
            background: linear-gradient(145deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            box-shadow: 
                0 4px 12px rgba(27, 54, 93, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .message.user .message-avatar {
            background: linear-gradient(145deg, #e2e8f0 0%, #cbd5e1 100%);
            color: #475569;
            box-shadow: 
                0 4px 12px rgba(71, 85, 105, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }
        
        .message-bubble {
            padding: 14px 18px;
            border-radius: 20px;
            font-size: 15px;
            line-height: 1.5;
            position: relative;
            word-break: break-word;
            font-weight: 500;
        }
        
        .message.agent .message-bubble {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            color: #475569;
            border-bottom-left-radius: 6px;
            border: 1px solid rgba(226, 232, 240, 0.5);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.08),
                0 2px 4px rgba(0, 0, 0, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }
        
        .message.agent .message-bubble::before {
            content: '';
            position: absolute;
            left: -8px;
            bottom: 6px;
            width: 0;
            height: 0;
            border: 8px solid transparent;
            border-right-color: #ffffff;
            border-left: none;
            filter: drop-shadow(-1px 0 1px rgba(0, 0, 0, 0.05));
        }
        
        .message.user .message-bubble {
            background: linear-gradient(145deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border-bottom-right-radius: 6px;
            box-shadow: 
                0 4px 16px rgba(27, 54, 93, 0.25),
                0 2px 4px rgba(27, 54, 93, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .message.user .message-bubble::before {
            content: '';
            position: absolute;
            right: -8px;
            bottom: 6px;
            width: 0;
            height: 0;
            border: 8px solid transparent;
            border-left-color: var(--primary);
            border-right: none;
            filter: drop-shadow(1px 0 1px rgba(0, 0, 0, 0.15));
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 16px 0;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
            align-items: center;
            background: white;
            padding: 12px 16px;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #94a3b8;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        .chat-input-area {
            padding: 16px 20px;
            background: white;
            border-top: 1px solid #e2e8f0;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .quick-replies {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .quick-reply {
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            color: #475569;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .quick-reply:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .chat-input {
            display: flex;
            align-items: center;
            gap: 12px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 24px;
            padding: 4px;
            transition: all 0.2s ease;
        }
        
        .chat-input:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(27, 54, 93, 0.1);
        }
        
        .chat-input input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 12px 16px;
            font-size: 15px;
            outline: none;
            color: #1e293b;
        }
        
        .chat-input input::placeholder {
            color: #94a3b8;
        }
        
        .send-button {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 4px;
        }
        
        .send-button:hover {
            transform: scale(1.05);
        }
        
        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Duplicate floating-button styles removed - consolidated above */
        
        .conversation-step {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .step-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .step-title {
            font-size: 18px;
            font-weight: 600;
            color: #1e293b;
        }
        
        .form-field {
            margin-bottom: 16px;
        }
        
        .field-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
            font-size: 14px;
        }
        
        .field-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.2s ease;
            background: #f9fafb;
        }
        
        .field-input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(27, 54, 93, 0.1);
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .action-button {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-button.primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }
        
        .action-button.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(27, 54, 93, 0.3);
        }
        
        .action-button.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .action-button.secondary:hover {
            background: #e2e8f0;
        }
        
        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .chat-widget.popup {
                width: 95vw;
                height: 90vh;
                max-width: none;
                max-height: none;
            }
            
            .chat-widget.slide {
                width: 100vw;
                min-width: 100vw;
                right: -100vw;
            }
            
            .chat-widget.slide.active {
                right: 0;
            }
            
            .chat-widget.embedded {
                max-width: 100%;
                height: 600px;
            }
            
            .floating-button {
                width: 56px;
                height: 56px;
                font-size: 24px;
                bottom: 20px;
                right: 20px;
            }
            
            .demo-menu {
                top: var(--space-sm);
                right: var(--space-sm);
                min-width: 250px;
            }
            
            .demo-menu.collapsed {
                width: 50px;
                min-width: 50px;
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-content {
                grid-template-columns: 1fr;
                gap: var(--space-2xl);
                text-align: center;
            }
            
            .hero-text h1 {
                font-size: var(--font-size-4xl);
            }
            
            .nav-links {
                display: none;
            }
            
            .features-grid,
            .properties-grid {
                grid-template-columns: 1fr;
            }
            
            .demo-menu {
                top: var(--space-sm);
                right: var(--space-sm);
                left: var(--space-sm);
                min-width: auto;
            }
            
            .slide-panel {
                width: 100vw;
                min-width: 100vw;
                right: -100vw;
                border-radius: 0;
            }
            
            .popup-form {
                margin: var(--space-lg);
                width: calc(100% - var(--space-2xl));
            }
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        .animate-pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <nav class="nav">
                <a href="#" class="logo">ACME Rentals</a>
                <ul class="nav-links">
                    <li><a href="#properties" class="nav-link">Properties</a></li>
                    <li><a href="#services" class="nav-link">Services</a></li>
                    <li><a href="#about" class="nav-link">About</a></li>
                    <li><a href="#contact" class="nav-link">Contact</a></li>
                </ul>
                <a href="#contact" class="btn btn-primary">Schedule Tour</a>
            </nav>
        </div>
    </header>

    <!-- Demo Menu Overlay -->
    <div class="demo-menu" id="demoMenu">
        <button class="demo-menu-toggle" id="demoMenuToggle" title="Toggle Demo Menu">
            <span class="material-symbols-outlined">menu</span>
        </button>
        <div class="demo-menu-content">
            <div class="demo-menu-header">
                <div class="demo-menu-title">🎯 Live Demo Menu</div>
                <div class="demo-menu-subtitle">Switch between lead magnet types</div>
            </div>
            <div class="demo-menu-options">
            <div class="demo-option active" data-widget="popup">
                <div class="demo-option-info">
                    <div class="demo-option-icon">
                        <span class="material-symbols-outlined">web_asset</span>
                    </div>
                    <div class="demo-option-text">
                        <div class="demo-option-title">Popup Form</div>
                        <div class="demo-option-desc">Modal overlay</div>
                    </div>
                </div>
                <div class="demo-option-status"></div>
            </div>
            <div class="demo-option" data-widget="slide-in">
                <div class="demo-option-info">
                    <div class="demo-option-icon">
                        <span class="material-symbols-outlined">view_sidebar</span>
                    </div>
                    <div class="demo-option-text">
                        <div class="demo-option-title">Slide-in Panel</div>
                        <div class="demo-option-desc">Side panel</div>
                    </div>
                </div>
                <div class="demo-option-status"></div>
            </div>
            <div class="demo-option" data-widget="embedded">
                <div class="demo-option-info">
                    <div class="demo-option-icon">
                        <span class="material-symbols-outlined">web</span>
                    </div>
                    <div class="demo-option-text">
                        <div class="demo-option-title">Embedded Form</div>
                        <div class="demo-option-desc">In-page form</div>
                    </div>
                </div>
                <div class="demo-option-status"></div>
            </div>
            <div class="demo-option" data-widget="floating">
                <div class="demo-option-info">
                    <div class="demo-option-icon">
                        <span class="material-symbols-outlined">bubble_chart</span>
                    </div>
                    <div class="demo-option-text">
                        <div class="demo-option-title">Floating Button</div>
                        <div class="demo-option-desc">Fixed position</div>
                    </div>
                </div>
                <div class="demo-option-status"></div>
            </div>
        </div>
        
        <!-- Mode Toggle -->
        <div class="demo-mode-toggle">
            <div class="demo-mode-header">
                <div class="demo-mode-title">Lead Magnet Mode</div>
            </div>
            <div class="demo-toggle-switch">
                <input type="checkbox" id="conversationalToggle" checked>
                <label for="conversationalToggle" class="toggle-label">
                    <span class="toggle-text-off">Static Forms</span>
                    <span class="toggle-slider"></span>
                    <span class="toggle-text-on">Conversational AI</span>
                </label>
            </div>
        </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1>Premium Properties.<br>Luxury Living.</h1>
                    <p>Discover exceptional rental properties in the heart of the city. From modern apartments to luxury homes, find your perfect space with ACME Rentals.</p>
                    <div class="hero-actions">
                        <a href="#properties" class="btn btn-primary">Browse Properties</a>
                        <a href="#contact" class="btn btn-outline">Schedule Tour</a>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='500' viewBox='0 0 600 500'><rect width='600' height='500' fill='%23f8f9fa'/><rect x='50' y='100' width='500' height='300' fill='%23e9ecef'/><rect x='100' y='150' width='150' height='100' fill='%23C69C6C'/><rect x='350' y='150' width='150' height='100' fill='%231B365D'/><text x='300' y='280' text-anchor='middle' font-family='Inter,sans-serif' font-size='18' fill='%23495057'>Luxury Apartment Complex</text></svg>" alt="Luxury Apartment Complex">
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="services">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Why Choose ACME Rentals</h2>
                <p class="section-subtitle">Experience the difference with our premium rental services and exceptional properties</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-symbols-outlined">star</span>
                    </div>
                    <h3 class="feature-title">Premium Locations</h3>
                    <p class="feature-description">Prime locations in the city's most desirable neighborhoods, close to shopping, dining, and transportation.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-symbols-outlined">support_agent</span>
                    </div>
                    <h3 class="feature-title">24/7 Support</h3>
                    <p class="feature-description">Round-the-clock customer service and maintenance support to ensure your comfort and peace of mind.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-symbols-outlined">verified</span>
                    </div>
                    <h3 class="feature-title">Verified Properties</h3>
                    <p class="feature-description">All properties are thoroughly inspected and verified to meet our high standards of quality and safety.</p>
                </div>
            </div>
        </div>

        <!-- Embedded Form (hidden by default) -->
        <div class="container">
            <div class="embedded-form" id="embeddedForm">
                <div class="conversational-widget-container" id="embeddedConversational">
                    <!-- Conversational widget will be dynamically inserted here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Properties Section -->
    <section class="properties" id="properties">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Featured Properties</h2>
                <p class="section-subtitle">Explore our handpicked selection of premium rental properties</p>
            </div>
            <div class="properties-grid">
                <div class="property-card">
                    <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='400' height='250' viewBox='0 0 400 250'><rect width='400' height='250' fill='%23f8f9fa'/><rect x='50' y='50' width='300' height='150' fill='%231B365D'/><rect x='100' y='80' width='80' height='60' fill='%23C69C6C'/><rect x='220' y='80' width='80' height='60' fill='%23C69C6C'/><text x='200' y='220' text-anchor='middle' font-family='Inter,sans-serif' font-size='14' fill='%23495057'>Modern Downtown Apartment</text></svg>" alt="Modern Downtown Apartment" class="property-image">
                    <div class="property-content">
                        <div class="property-price">$3,200/month</div>
                        <h3 class="property-title">Modern Downtown Apartment</h3>
                        <div class="property-details">
                            <div class="property-detail">
                                <span class="material-symbols-outlined">bed</span>
                                <span>2 Beds</span>
                            </div>
                            <div class="property-detail">
                                <span class="material-symbols-outlined">bathtub</span>
                                <span>2 Baths</span>
                            </div>
                            <div class="property-detail">
                                <span class="material-symbols-outlined">square_foot</span>
                                <span>1,200 sq ft</span>
                            </div>
                        </div>
                        <a href="#" class="btn btn-primary">View Details</a>
                    </div>
                </div>
                <div class="property-card">
                    <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='400' height='250' viewBox='0 0 400 250'><rect width='400' height='250' fill='%23f8f9fa'/><rect x='30' y='40' width='340' height='170' fill='%23C69C6C'/><rect x='80' y='70' width='60' height='50' fill='%231B365D'/><rect x='170' y='70' width='60' height='50' fill='%231B365D'/><rect x='260' y='70' width='60' height='50' fill='%231B365D'/><text x='200' y='230' text-anchor='middle' font-family='Inter,sans-serif' font-size='14' fill='%23495057'>Luxury Penthouse Suite</text></svg>" alt="Luxury Penthouse Suite" class="property-image">
                    <div class="property-content">
                        <div class="property-price">$5,800/month</div>
                        <h3 class="property-title">Luxury Penthouse Suite</h3>
                        <div class="property-details">
                            <div class="property-detail">
                                <span class="material-symbols-outlined">bed</span>
                                <span>3 Beds</span>
                            </div>
                            <div class="property-detail">
                                <span class="material-symbols-outlined">bathtub</span>
                                <span>3 Baths</span>
                            </div>
                            <div class="property-detail">
                                <span class="material-symbols-outlined">square_foot</span>
                                <span>2,100 sq ft</span>
                            </div>
                        </div>
                        <a href="#" class="btn btn-primary">View Details</a>
                    </div>
                </div>
                <div class="property-card">
                    <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='400' height='250' viewBox='0 0 400 250'><rect width='400' height='250' fill='%23f8f9fa'/><rect x='40' y='60' width='320' height='130' fill='%23e9ecef'/><rect x='70' y='80' width='70' height='60' fill='%231B365D'/><rect x='165' y='80' width='70' height='60' fill='%23C69C6C'/><rect x='260' y='80' width='70' height='60' fill='%231B365D'/><text x='200' y='220' text-anchor='middle' font-family='Inter,sans-serif' font-size='14' fill='%23495057'>Family Townhouse</text></svg>" alt="Family Townhouse" class="property-image">
                    <div class="property-content">
                        <div class="property-price">$4,100/month</div>
                        <h3 class="property-title">Family Townhouse</h3>
                        <div class="property-details">
                            <div class="property-detail">
                                <span class="material-symbols-outlined">bed</span>
                                <span>4 Beds</span>
                            </div>
                            <div class="property-detail">
                                <span class="material-symbols-outlined">bathtub</span>
                                <span>2.5 Baths</span>
                            </div>
                            <div class="property-detail">
                                <span class="material-symbols-outlined">square_foot</span>
                                <span>1,800 sq ft</span>
                            </div>
                        </div>
                        <a href="#" class="btn btn-primary">View Details</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta" id="contact">
        <div class="container">
            <h2>Ready to Find Your Perfect Home?</h2>
            <p>Schedule a personalized tour of our premium properties today</p>
            <a href="#" class="btn btn-secondary" onclick="showLeadMagnet()">Schedule Free Tour</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ACME Rentals</h4>
                    <p>Premium properties for discerning tenants. Experience luxury living at its finest.</p>
                </div>
                <div class="footer-section">
                    <h4>Properties</h4>
                    <ul class="footer-links">
                        <li><a href="#">Apartments</a></li>
                        <li><a href="#">Condos</a></li>
                        <li><a href="#">Townhouses</a></li>
                        <li><a href="#">Single Family Homes</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul class="footer-links">
                        <li><a href="#">Property Management</a></li>
                        <li><a href="#">Tenant Screening</a></li>
                        <li><a href="#">Maintenance Services</a></li>
                        <li><a href="#">Virtual Tours</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <ul class="footer-links">
                        <li><a href="tel:555-123-4567">(555) 123-4567</a></li>
                        <li><a href="mailto:info@acmerentals.com">info@acmerentals.com</a></li>
                        <li><a href="#">123 Property Lane, City, ST 12345</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ACME Rentals. All rights reserved. | <a href="#" style="color: var(--secondary);">Privacy Policy</a> | <a href="#" style="color: var(--secondary);">Terms of Service</a></p>
            </div>
        </div>
    </footer>

    <!-- Lead Magnet Widgets -->
    
    <!-- Popup Form -->
    <div class="popup-overlay" id="popupForm">
        <div class="popup-form">
            <button class="form-close" onclick="hideLeadMagnet()">&times;</button>
            <div class="conversational-widget-container" id="popupConversational">
                <!-- Conversational widget will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Slide-in Panel with Backdrop -->
    <div class="slide-backdrop" id="slideBackdrop" onclick="hideLeadMagnet()"></div>
    <div class="slide-panel" id="slidePanel">
        <button class="form-close" onclick="hideLeadMagnet()">&times;</button>
        <div class="conversational-widget-container" id="slideConversational">
            <!-- Conversational widget will be dynamically inserted here -->
        </div>
    </div>

    <!-- Floating Button -->
    <div class="floating-button" id="floatingButton" onclick="activateFloatingWidget()">
        <div class="floating-tooltip">Schedule a tour!</div>
        <span class="material-symbols-outlined">home</span>
    </div>
    
    <!-- Floating Widget Container -->
    <div class="floating-widget-container" id="floatingConversational">
        <!-- Conversational widget will be dynamically inserted here -->
    </div>

    <script>
        // Conversational Lead Magnet Framework
        class ConversationalLeadMagnet {
            constructor(config) {
                this.config = {
                    industry: config.industry || 'real-estate',
                    businessName: config.businessName || 'Business',
                    brandColors: config.brandColors || {primary: '#1B365D', secondary: '#C69C6C'},
                    qualificationFlow: config.qualificationFlow || 'basic',
                    valueDelivery: config.valueDelivery || [],
                    primaryCTA: config.primaryCTA || 'book-appointment',
                    secondaryCTA: config.secondaryCTA || 'request-callback',
                    availableCTAs: config.availableCTAs || ['book', 'text', 'call', 'email'],
                    integrations: config.integrations || {},
                    ...config
                };
                
                this.conversation = {
                    step: 0,
                    data: {},
                    context: {}
                };
                
                this.templates = this.getIndustryTemplate();
                this.init();
            }
            
            getIndustryTemplate() {
                const templates = {
                    'real-estate': {
                        flows: {
                            'property-investment': {
                                steps: [
                                    {
                                        id: 'intent',
                                        message: 'Hi! Are you looking to buy, sell, or invest in property? 🏠',
                                        options: ['Buy', 'Sell', 'Invest', 'Just browsing'],
                                        quick: true
                                    },
                                    {
                                        id: 'budget',
                                        message: 'What\'s your budget range?',
                                        options: ['Under $200K', '$200K-$500K', '$500K-$1M', '$1M+', 'Not sure yet'],
                                        conditional: (data) => data.intent !== 'Just browsing'
                                    },
                                    {
                                        id: 'timeline',
                                        message: 'When are you looking to make a move?',
                                        options: ['ASAP', 'Next 3 months', '3-6 months', '6+ months', 'Just researching'],
                                        conditional: (data) => data.intent !== 'Just browsing'
                                    },
                                    {
                                        id: 'location',
                                        message: 'Which area interests you most?',
                                        options: ['Downtown', 'Suburbs', 'Waterfront', 'Business District', 'Historic Area', 'University District']
                                    },
                                    {
                                        id: 'value-delivery',
                                        message: 'Perfect! Let me show you some insights...',
                                        action: 'showValue'
                                    },
                                    {
                                        id: 'cta',
                                        message: 'Ready to take the next step?',
                                        action: 'showCTAs'
                                    }
                                ]
                            }
                        },
                        valueModules: {
                            'roi-calculator': {
                                title: '📊 ROI Analysis',
                                generate: (data) => {
                                    const budget = this.parseBudget(data.budget);
                                    const roi = this.calculateROI(budget, data.location);
                                    return `Based on your ${data.budget} budget in ${data.location}, here's what I found:<br><br>
                                           💰 Avg. Property Price: $${budget.avg.toLocaleString()}<br>
                                           📈 Expected ROI: ${roi.percentage}% annually<br>
                                           💵 Monthly Cash Flow: $${roi.monthly.toLocaleString()}<br>
                                           🏆 Market Rating: ${roi.rating}/5 stars`;
                                }
                            },
                            'property-matching': {
                                title: '🎯 Perfect Matches',
                                generate: (data) => {
                                    const matches = this.findPropertyMatches(data);
                                    return `I found ${matches.length} properties that match your criteria:<br><br>` +
                                           matches.map(p => `🏠 ${p.address} - $${p.price.toLocaleString()}<br>
                                                              📍 ${p.neighborhood} • ${p.type}<br>
                                                              ⭐ ${p.score}/100 match score`).join('<br><br>');
                                }
                            },
                            'market-insights': {
                                title: '📈 Market Trends',
                                generate: (data) => {
                                    const trends = this.getMarketTrends(data.location);
                                    return `Market insights for ${data.location}:<br><br>
                                           📊 Price trend: ${trends.direction} ${trends.percentage}% this year<br>
                                           🏠 Inventory: ${trends.inventory} (${trends.market} market)<br>
                                           📅 Avg. days on market: ${trends.dom} days<br>
                                           🎯 Best time to ${data.intent.toLowerCase()}: ${trends.timing}`;
                                }
                            }
                        },
                        ctas: {
                            'book-appointment': {
                                icon: '📅',
                                text: 'Schedule Property Tour',
                                action: 'calendar',
                                priority: 1
                            },
                            'request-callback': {
                                icon: '☎️',
                                text: 'Request Callback',
                                action: 'callback',
                                priority: 2
                            },
                            'text-updates': {
                                icon: '📱',
                                text: 'Text Me New Listings',
                                action: 'sms-opt-in',
                                priority: 3
                            },
                            'email-report': {
                                icon: '📧',
                                text: 'Email Market Report',
                                action: 'email-delivery',
                                priority: 4
                            }
                        }
                    }
                };
                
                return templates[this.config.industry] || templates['real-estate'];
            }
            
            init() {
                this.createChatWidget();
                this.bindEvents();
            }
            
            createChatWidget() {
                const widget = document.createElement('div');
                widget.id = 'conversational-lead-magnet';
                widget.innerHTML = `
                    <div class="clm-widget">
                        <div class="clm-trigger" id="clmTrigger">
                            <div class="clm-trigger-icon">💬</div>
                            <div class="clm-trigger-text">Chat with us!</div>
                            <div class="clm-trigger-pulse"></div>
                        </div>
                        <div class="clm-chat" id="clmChat">
                            <div class="clm-header">
                                <div class="clm-avatar">🏠</div>
                                <div class="clm-title">${this.config.businessName} Assistant</div>
                                <div class="clm-close" id="clmClose">×</div>
                            </div>
                            <div class="clm-messages" id="clmMessages">
                                <div class="clm-message clm-bot">
                                    <div class="clm-message-content">
                                        Welcome! I'm here to help you find the perfect property. How can I assist you today?
                                    </div>
                                </div>
                            </div>
                            <div class="clm-input-area" id="clmInputArea">
                                <!-- Dynamic input will be inserted here -->
                            </div>
                        </div>
                    </div>
                `;
                
                // Add styles
                const styles = document.createElement('style');
                styles.textContent = this.getChatStyles();
                document.head.appendChild(styles);
                
                document.body.appendChild(widget);
                
                // Start conversation
                setTimeout(() => this.startConversation(), 1000);
            }
            
            getChatStyles() {
                return `
                    .clm-widget {
                        position: fixed;
                        bottom: 20px;
                        left: 20px;
                        z-index: 10000;
                        font-family: 'Inter', sans-serif;
                    }
                    
                    .clm-trigger {
                        background: linear-gradient(135deg, ${this.config.brandColors.primary}, ${this.config.brandColors.secondary});
                        color: white;
                        padding: 12px 20px;
                        border-radius: 50px;
                        cursor: pointer;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        position: relative;
                        transition: all 0.3s ease;
                        max-width: 200px;
                    }
                    
                    .clm-trigger:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 25px rgba(0,0,0,0.2);
                    }
                    
                    .clm-trigger-pulse {
                        position: absolute;
                        top: -5px;
                        right: -5px;
                        width: 20px;
                        height: 20px;
                        background: #ff4444;
                        border-radius: 50%;
                        animation: pulse 2s infinite;
                    }
                    
                    .clm-chat {
                        width: 380px;
                        height: 500px;
                        background: white;
                        border-radius: 16px;
                        box-shadow: 0 10px 40px rgba(0,0,0,0.15);
                        display: none;
                        flex-direction: column;
                        margin-bottom: 10px;
                        overflow: hidden;
                    }
                    
                    .clm-chat.active {
                        display: flex;
                        animation: slideInUp 0.3s ease-out;
                    }
                    
                    .clm-header {
                        background: linear-gradient(135deg, ${this.config.brandColors.primary}, ${this.config.brandColors.secondary});
                        color: white;
                        padding: 16px 20px;
                        display: flex;
                        align-items: center;
                        gap: 12px;
                    }
                    
                    .clm-avatar {
                        width: 40px;
                        height: 40px;
                        border-radius: 50%;
                        background: rgba(255,255,255,0.2);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 18px;
                    }
                    
                    .clm-title {
                        flex: 1;
                        font-weight: 600;
                        font-size: 16px;
                    }
                    
                    .clm-close {
                        width: 30px;
                        height: 30px;
                        border-radius: 50%;
                        background: rgba(255,255,255,0.2);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        font-size: 18px;
                        transition: background 0.2s ease;
                    }
                    
                    .clm-close:hover {
                        background: rgba(255,255,255,0.3);
                    }
                    
                    .clm-messages {
                        flex: 1;
                        padding: 20px;
                        overflow-y: auto;
                        display: flex;
                        flex-direction: column;
                        gap: 16px;
                    }
                    
                    .clm-message {
                        display: flex;
                        align-items: flex-start;
                        gap: 8px;
                    }
                    
                    .clm-message.clm-user {
                        flex-direction: row-reverse;
                    }
                    
                    .clm-message-content {
                        background: #f1f3f5;
                        padding: 12px 16px;
                        border-radius: 18px;
                        max-width: 80%;
                        line-height: 1.4;
                        font-size: 14px;
                    }
                    
                    .clm-user .clm-message-content {
                        background: ${this.config.brandColors.primary};
                        color: white;
                    }
                    
                    .clm-input-area {
                        padding: 20px;
                        border-top: 1px solid #e9ecef;
                        background: #f8f9fa;
                    }
                    
                    .clm-options {
                        display: flex;
                        flex-direction: column;
                        gap: 8px;
                    }
                    
                    .clm-option {
                        background: white;
                        border: 2px solid #e9ecef;
                        padding: 12px 16px;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        text-align: center;
                        font-weight: 500;
                    }
                    
                    .clm-option:hover {
                        border-color: ${this.config.brandColors.secondary};
                        background: ${this.config.brandColors.secondary}15;
                    }
                    
                    .clm-text-input {
                        width: 100%;
                        padding: 12px 16px;
                        border: 2px solid #e9ecef;
                        border-radius: 12px;
                        font-size: 14px;
                        transition: border-color 0.2s ease;
                        margin-bottom: 12px;
                    }
                    
                    .clm-text-input:focus {
                        outline: none;
                        border-color: ${this.config.brandColors.secondary};
                    }
                    
                    .clm-submit {
                        background: ${this.config.brandColors.primary};
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 12px;
                        cursor: pointer;
                        font-weight: 600;
                        width: 100%;
                        transition: all 0.2s ease;
                    }
                    
                    .clm-submit:hover {
                        background: ${this.config.brandColors.secondary};
                    }
                    
                    .clm-value-display {
                        background: white;
                        border: 2px solid ${this.config.brandColors.secondary};
                        border-radius: 12px;
                        padding: 16px;
                        margin: 12px 0;
                    }
                    
                    .clm-value-title {
                        font-weight: 600;
                        color: ${this.config.brandColors.primary};
                        margin-bottom: 8px;
                    }
                    
                    .clm-cta-options {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 8px;
                        margin-top: 16px;
                    }
                    
                    .clm-cta {
                        background: white;
                        border: 2px solid ${this.config.brandColors.primary};
                        color: ${this.config.brandColors.primary};
                        padding: 12px 8px;
                        border-radius: 12px;
                        cursor: pointer;
                        text-align: center;
                        font-weight: 600;
                        font-size: 12px;
                        transition: all 0.2s ease;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 4px;
                    }
                    
                    .clm-cta:hover {
                        background: ${this.config.brandColors.primary};
                        color: white;
                    }
                    
                    .clm-cta.primary {
                        background: ${this.config.brandColors.primary};
                        color: white;
                        grid-column: 1 / -1;
                    }
                    
                    @keyframes slideInUp {
                        from {
                            opacity: 0;
                            transform: translateY(20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                    
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); opacity: 1; }
                        50% { transform: scale(1.1); opacity: 0.7; }
                    }
                    
                    @media (max-width: 480px) {
                        .clm-widget {
                            left: 10px;
                            right: 10px;
                        }
                        
                        .clm-chat {
                            width: calc(100vw - 20px);
                            height: calc(100vh - 40px);
                            margin: 10px;
                            position: fixed;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            margin: auto;
                        }
                        
                        .clm-trigger {
                            position: fixed;
                            bottom: 20px;
                            left: 20px;
                            right: 20px;
                            max-width: none;
                            justify-content: center;
                        }
                    }
                `;
            }
            
            bindEvents() {
                document.getElementById('clmTrigger').addEventListener('click', () => {
                    this.showChat();
                });
                
                document.getElementById('clmClose').addEventListener('click', () => {
                    this.hideChat();
                });
            }
            
            showChat() {
                document.getElementById('clmChat').classList.add('active');
                document.getElementById('clmTrigger').style.display = 'none';
            }
            
            hideChat() {
                document.getElementById('clmChat').classList.remove('active');
                document.getElementById('clmTrigger').style.display = 'flex';
            }
            
            startConversation() {
                const flow = this.templates.flows[this.config.qualificationFlow];
                if (flow && flow.steps.length > 0) {
                    this.showStep(flow.steps[0]);
                }
            }
            
            showStep(step) {
                if (step.conditional && !step.conditional(this.conversation.data)) {
                    this.nextStep();
                    return;
                }
                
                this.addBotMessage(step.message);
                
                if (step.action) {
                    this.executeAction(step.action);
                } else if (step.options) {
                    this.showOptions(step.options, step.id);
                } else if (step.input) {
                    this.showInput(step.input, step.id, step.placeholder);
                }
            }
            
            showOptions(options, stepId) {
                const inputArea = document.getElementById('clmInputArea');
                inputArea.innerHTML = `
                    <div class="clm-options">
                        ${options.map(option => `
                            <div class="clm-option" data-value="${option}" data-step="${stepId}">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                `;
                
                inputArea.querySelectorAll('.clm-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const value = e.target.dataset.value;
                        const step = e.target.dataset.step;
                        this.handleUserResponse(value, step);
                    });
                });
            }
            
            showInput(inputType, stepId, placeholder = '') {
                const inputArea = document.getElementById('clmInputArea');
                const inputElement = inputType === 'textarea' ? 
                    `<textarea class="clm-text-input" placeholder="${placeholder}" rows="3"></textarea>` :
                    `<input type="text" class="clm-text-input" placeholder="${placeholder}">`;
                
                inputArea.innerHTML = `
                    ${inputElement}
                    <button class="clm-submit" data-step="${stepId}">Send</button>
                `;
                
                const submitBtn = inputArea.querySelector('.clm-submit');
                const input = inputArea.querySelector('.clm-text-input');
                
                submitBtn.addEventListener('click', () => {
                    const value = input.value.trim();
                    if (value) {
                        this.handleUserResponse(value, stepId);
                    }
                });
                
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        submitBtn.click();
                    }
                });
                
                input.focus();
            }
            
            handleUserResponse(value, stepId) {
                this.addUserMessage(value);
                this.conversation.data[stepId] = value;
                
                document.getElementById('clmInputArea').innerHTML = '';
                
                setTimeout(() => {
                    this.nextStep();
                }, 500);
            }
            
            nextStep() {
                this.conversation.step++;
                const flow = this.templates.flows[this.config.qualificationFlow];
                
                if (this.conversation.step < flow.steps.length) {
                    setTimeout(() => {
                        this.showStep(flow.steps[this.conversation.step]);
                    }, 1000);
                }
            }
            
            executeAction(action) {
                switch(action) {
                    case 'showValue':
                        this.showValueDelivery();
                        break;
                    case 'showCTAs':
                        this.showCTAOptions();
                        break;
                }
            }
            
            showValueDelivery() {
                const modules = this.config.valueDelivery;
                const inputArea = document.getElementById('clmInputArea');
                
                let content = '';
                modules.forEach(moduleId => {
                    if (this.templates.valueModules[moduleId]) {
                        const module = this.templates.valueModules[moduleId];
                        const value = module.generate.call(this, this.conversation.data);
                        content += `
                            <div class="clm-value-display">
                                <div class="clm-value-title">${module.title}</div>
                                <div>${value}</div>
                            </div>
                        `;
                    }
                });
                
                inputArea.innerHTML = content;
                
                setTimeout(() => {
                    this.nextStep();
                }, 3000);
            }
            
            showCTAOptions() {
                const inputArea = document.getElementById('clmInputArea');
                const ctas = this.templates.ctas;
                const availableCTAs = this.config.availableCTAs;
                
                let ctaHTML = '<div class="clm-cta-options">';
                
                // Primary CTA
                const primaryCTA = ctas[this.config.primaryCTA];
                if (primaryCTA) {
                    ctaHTML += `
                        <div class="clm-cta primary" data-action="${this.config.primaryCTA}">
                            <span>${primaryCTA.icon}</span>
                            <span>${primaryCTA.text}</span>
                        </div>
                    `;
                }
                
                // Secondary CTAs
                availableCTAs.forEach(ctaId => {
                    if (ctaId !== this.config.primaryCTA && ctas[ctaId]) {
                        const cta = ctas[ctaId];
                        ctaHTML += `
                            <div class="clm-cta" data-action="${ctaId}">
                                <span>${cta.icon}</span>
                                <span>${cta.text}</span>
                            </div>
                        `;
                    }
                });
                
                ctaHTML += '</div>';
                inputArea.innerHTML = ctaHTML;
                
                // Bind CTA events
                inputArea.querySelectorAll('.clm-cta').forEach(cta => {
                    cta.addEventListener('click', (e) => {
                        const action = e.target.closest('.clm-cta').dataset.action;
                        this.executeCTA(action);
                    });
                });
            }
            
            executeCTA(action) {
                switch(action) {
                    case 'book-appointment':
                        this.addBotMessage('Perfect! Opening our calendar... 📅');
                        // Integration with calendar system
                        setTimeout(() => {
                            window.open('https://calendly.com/acme-rentals', '_blank');
                        }, 1000);
                        break;
                        
                    case 'request-callback':
                        this.collectCallbackInfo();
                        break;
                        
                    case 'text-updates':
                        this.collectPhoneNumber();
                        break;
                        
                    case 'email-report':
                        this.collectEmailAddress();
                        break;
                }
            }
            
            collectCallbackInfo() {
                this.addBotMessage('I\'ll have one of our agents call you. What\'s the best number to reach you?');
                
                const inputArea = document.getElementById('clmInputArea');
                inputArea.innerHTML = `
                    <input type="tel" class="clm-text-input" placeholder="Your phone number">
                    <button class="clm-submit">Schedule Callback</button>
                `;
                
                const submitBtn = inputArea.querySelector('.clm-submit');
                const input = inputArea.querySelector('.clm-text-input');
                
                submitBtn.addEventListener('click', () => {
                    const phone = input.value.trim();
                    if (phone) {
                        this.addUserMessage(phone);
                        this.addBotMessage('Great! We\'ll call you within the next hour. Thanks for your interest! 📞');
                        this.trackConversion('callback-requested', { phone, data: this.conversation.data });
                        inputArea.innerHTML = '';
                    }
                });
            }
            
            collectPhoneNumber() {
                this.addBotMessage('I\'ll send you our best listings! What\'s your mobile number?');
                
                const inputArea = document.getElementById('clmInputArea');
                inputArea.innerHTML = `
                    <input type="tel" class="clm-text-input" placeholder="Your mobile number">
                    <button class="clm-submit">Start Text Updates</button>
                `;
                
                const submitBtn = inputArea.querySelector('.clm-submit');
                const input = inputArea.querySelector('.clm-text-input');
                
                submitBtn.addEventListener('click', () => {
                    const phone = input.value.trim();
                    if (phone) {
                        this.addUserMessage(phone);
                        this.addBotMessage('Perfect! You\'ll get our best listings via text. Welcome to the VIP list! 📱');
                        this.trackConversion('sms-opt-in', { phone, data: this.conversation.data });
                        inputArea.innerHTML = '';
                    }
                });
            }
            
            collectEmailAddress() {
                this.addBotMessage('I\'ll email you a detailed market report! What\'s your email address?');
                
                const inputArea = document.getElementById('clmInputArea');
                inputArea.innerHTML = `
                    <input type="email" class="clm-text-input" placeholder="Your email address">
                    <button class="clm-submit">Send Report</button>
                `;
                
                const submitBtn = inputArea.querySelector('.clm-submit');
                const input = inputArea.querySelector('.clm-text-input');
                
                submitBtn.addEventListener('click', () => {
                    const email = input.value.trim();
                    if (email) {
                        this.addUserMessage(email);
                        this.addBotMessage('Excellent! Check your inbox in the next few minutes. The report has everything you need! 📧');
                        this.trackConversion('email-report', { email, data: this.conversation.data });
                        inputArea.innerHTML = '';
                    }
                });
            }
            
            addBotMessage(message) {
                const messagesContainer = document.getElementById('clmMessages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'clm-message clm-bot';
                messageDiv.innerHTML = `
                    <div class="clm-message-content">${message}</div>
                `;
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            addUserMessage(message) {
                const messagesContainer = document.getElementById('clmMessages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'clm-message clm-user';
                messageDiv.innerHTML = `
                    <div class="clm-message-content">${message}</div>
                `;
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // Helper methods for value delivery
            parseBudget(budgetStr) {
                const budgetMap = {
                    'Under $200K': { min: 0, max: 200000, avg: 150000 },
                    '$200K-$500K': { min: 200000, max: 500000, avg: 350000 },
                    '$500K-$1M': { min: 500000, max: 1000000, avg: 750000 },
                    '$1M+': { min: 1000000, max: 5000000, avg: 2000000 },
                    'Not sure yet': { min: 0, max: 1000000, avg: 400000 }
                };
                return budgetMap[budgetStr] || budgetMap['Not sure yet'];
            }
            
            calculateROI(budget, location) {
                // Mock ROI calculation - in real implementation, this would call an API
                const baseROI = 8.5;
                const locationMultiplier = location.toLowerCase().includes('downtown') ? 1.2 : 1.0;
                const budgetMultiplier = budget.avg > 500000 ? 0.9 : 1.1;
                
                const roi = baseROI * locationMultiplier * budgetMultiplier;
                const monthlyReturn = (budget.avg * (roi / 100)) / 12;
                
                return {
                    percentage: roi.toFixed(1),
                    monthly: Math.round(monthlyReturn),
                    rating: Math.min(5, Math.round(roi / 2))
                };
            }
            
            findPropertyMatches(data) {
                // Mock property matching - in real implementation, this would query a database
                const mockProperties = [
                    {
                        address: '123 Main Street',
                        price: 450000,
                        neighborhood: data.location || 'Downtown',
                        type: 'Condo',
                        score: 95
                    },
                    {
                        address: '456 Oak Avenue',
                        price: 380000,
                        neighborhood: data.location || 'Suburbs',
                        type: 'Townhouse',
                        score: 88
                    },
                    {
                        address: '789 Pine Street',
                        price: 520000,
                        neighborhood: data.location || 'Waterfront',
                        type: 'Single Family',
                        score: 92
                    }
                ];
                
                return mockProperties.slice(0, 3);
            }
            
            getMarketTrends(location) {
                // Mock market trends - in real implementation, this would call a market data API
                return {
                    direction: 'Up',
                    percentage: '12.5',
                    inventory: '2.1 months',
                    market: 'seller\'s',
                    dom: 18,
                    timing: 'Spring (March-May)'
                };
            }
            
            trackConversion(event, data) {
                // Integration with analytics/CRM
                console.log('Conversion tracked:', event, data);
                
                // Example: Send to Google Analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'conversion', {
                        event_category: 'Lead Magnet',
                        event_label: event,
                        value: 1
                    });
                }
                
                // Example: Send to CRM/webhook
                if (this.config.webhookUrl) {
                    fetch(this.config.webhookUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            event,
                            data,
                            timestamp: Date.now(),
                            source: 'conversational-lead-magnet'
                        })
                    });
                }
            }
        }

        // Demo functionality
        let conversationalWidgets = {};
        let currentWidget = 'popup';
        let widgetInstances = {};
        let isConversationalMode = true;
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Header scroll effect
            window.addEventListener('scroll', function() {
                const header = document.getElementById('header');
                if (window.scrollY > 100) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
            
            // Demo menu functionality
            const demoOptions = document.querySelectorAll('.demo-option');
            demoOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const widget = this.dataset.widget;
                    switchWidget(widget);
                });
            });
            
            // Demo menu toggle functionality
            const demoMenu = document.getElementById('demoMenu');
            const demoMenuToggle = document.getElementById('demoMenuToggle');
            const toggleIcon = demoMenuToggle.querySelector('.material-symbols-outlined');
            
            demoMenuToggle.addEventListener('click', function() {
                demoMenu.classList.toggle('collapsed');
                
                if (demoMenu.classList.contains('collapsed')) {
                    toggleIcon.textContent = 'settings';
                    demoMenuToggle.title = 'Expand Demo Menu';
                } else {
                    toggleIcon.textContent = 'menu';
                    demoMenuToggle.title = 'Collapse Demo Menu';
                }
            });
            
            // Auto-collapse demo menu after 10 seconds to show clean demo
            setTimeout(() => {
                if (!demoMenu.classList.contains('collapsed')) {
                    demoMenuToggle.click();
                }
            }, 10000);
            
            // Conversational toggle functionality
            const conversationalToggle = document.getElementById('conversationalToggle');
            conversationalToggle.addEventListener('change', function() {
                const isConversational = this.checked;
                setConversationalMode(isConversational);
            });
            
            // Auto-show popup after 3 seconds (for demo)
            setTimeout(() => {
                if (currentWidget === 'popup') {
                    showLeadMagnet();
                }
            }, 3000);
            
            // Initialize conversational widgets
            initializeConversationalWidgets();
            
            // Initialize with popup widget
            switchWidget('popup');
            
            // Initialize floating button with delay and pulsing animation
            setTimeout(() => {
                const floatingBtn = document.getElementById('floatingButton');
                if (floatingBtn) {
                    floatingBtn.classList.add('active');
                    // Add pulsing animation after button appears to attract attention
                    setTimeout(() => {
                        floatingBtn.classList.add('pulse');
                        // Stop pulsing after 10 seconds to avoid being annoying
                        setTimeout(() => {
                            floatingBtn.classList.remove('pulse');
                        }, 10000);
                    }, 500);
                }
            }, 2000);
            
            // Form submissions
            const forms = document.querySelectorAll('.lead-form');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('🎉 Demo form submitted! In a real implementation, this would capture the lead data.');
                    hideLeadMagnet();
                });
            });
        });
        
        function switchWidget(widget) {
            // Deactivate current conversational widget
            if (conversationalWidgets[currentWidget] && conversationalWidgets[currentWidget].isActive) {
                conversationalWidgets[currentWidget].deactivate();
            }
            
            // Update active state in demo menu
            document.querySelectorAll('.demo-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`[data-widget="${widget}"]`).classList.add('active');
            
            // Hide all widgets
            hideAllWidgets();
            
            // Update current widget
            currentWidget = widget;
            
            // Show appropriate widget based on type
            setTimeout(() => {
                if (widget === 'popup') {
                    // Popup shows on trigger (button click or auto-show)
                } else if (widget === 'slide-in') {
                    showLeadMagnet();
                } else if (widget === 'embedded') {
                    document.getElementById('embeddedForm').classList.add('active');
                    // Auto-activate embedded conversational widget (only if in conversational mode)
                    if (isConversationalMode) {
                        const embeddedWidget = conversationalWidgets[widget];
                        if (embeddedWidget && !embeddedWidget.isActive) {
                            embeddedWidget.activate();
                        }
                    }
                } else if (widget === 'floating') {
                    const floatingBtn = document.getElementById('floatingButton');
                    floatingBtn.classList.add('active');
                    // Add pulsing animation to attract attention
                    setTimeout(() => {
                        floatingBtn.classList.add('pulse');
                    }, 1000);
                }
            }, 300);
        }
        
        function showLeadMagnet() {
            // Remove pulsing animation from floating button when clicked
            const floatingBtn = document.getElementById('floatingButton');
            if (floatingBtn) {
                floatingBtn.classList.remove('pulse');
            }
            
            // Show the appropriate container
            if (currentWidget === 'popup') {
                // Activate the conversational widget for popup (only if in conversational mode)
                if (isConversationalMode) {
                    const widget = conversationalWidgets[currentWidget];
                    if (widget && !widget.isActive) {
                        widget.activate();
                    }
                }
                document.getElementById('popupForm').classList.add('active');
                document.body.style.overflow = 'hidden';
            } else if (currentWidget === 'slide-in') {
                // Activate the conversational widget for slide-in (only if in conversational mode)
                if (isConversationalMode) {
                    const widget = conversationalWidgets[currentWidget];
                    if (widget && !widget.isActive) {
                        widget.activate();
                    }
                }
                document.getElementById('slideBackdrop').classList.add('active');
                document.getElementById('slidePanel').classList.add('active');
                document.body.style.overflow = 'hidden';
            } else if (currentWidget === 'embedded') {
                // Activate the conversational widget for embedded (only if in conversational mode)
                if (isConversationalMode) {
                    const widget = conversationalWidgets[currentWidget];
                    if (widget && !widget.isActive) {
                        widget.activate();
                    }
                }
                document.getElementById('embeddedForm').scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            } else if (currentWidget === 'floating') {
                // Floating widget opens in bottom-right, no modal overlay needed
                console.log('Floating widget via demo menu, currentWidget:', currentWidget);
                activateFloatingWidget();
            }
        }
        
        function activateFloatingWidget() {
            console.log('Floating button clicked directly');
            console.log('Current state - isConversationalMode:', isConversationalMode);
            console.log('Available widgets:', Object.keys(conversationalWidgets || {}));
            
            // Remove pulsing animation from floating button when clicked
            const floatingBtn = document.getElementById('floatingButton');
            if (floatingBtn) {
                floatingBtn.classList.remove('pulse');
            }
            
            // Ensure conversational widgets are initialized
            if (!conversationalWidgets) {
                console.log('Conversational widgets not initialized, initializing now');
                initializeConversationalWidgets();
            }
            
            // Force conversational mode for floating widget if needed
            if (!isConversationalMode) {
                console.log('Enabling conversational mode for floating widget');
                setConversationalMode(true);
                // Update the checkbox to reflect the change
                const conversationalToggle = document.getElementById('conversationalToggle');
                if (conversationalToggle) {
                    conversationalToggle.checked = true;
                }
            }
            
            // Add a small delay to prevent any immediate interference
            setTimeout(() => {
                // Activate floating widget (now that conversational mode is guaranteed)
                if (conversationalWidgets && conversationalWidgets['floating']) {
                    const widget = conversationalWidgets['floating'];
                    console.log('Floating widget object:', widget);
                    console.log('Widget isActive:', widget.isActive);
                    
                    if (!widget.isActive) {
                        console.log('Activating floating widget directly');
                        // Show the floating container first
                        const floatingContainer = document.getElementById('floatingConversational');
                        console.log('Floating container found:', floatingContainer);
                        if (floatingContainer) {
                            floatingContainer.classList.add('active');
                            console.log('Added active class to floating container');
                            console.log('Container classes:', floatingContainer.className);
                            // Small delay to ensure container is shown before widget activates
                            setTimeout(() => {
                                console.log('About to activate widget');
                                widget.activate();
                                console.log('Widget activated, isActive:', widget.isActive);
                                
                                // Double-check the container is still active after a short delay
                                setTimeout(() => {
                                    console.log('Checking container state after activation:', floatingContainer.className);
                                    console.log('Widget still active:', widget.isActive);
                                }, 200);
                            }, 100);
                        } else {
                            console.log('Container not found, activating widget directly');
                            widget.activate();
                        }
                    } else {
                        console.log('Widget already active, hiding it');
                        hideFloatingWidget();
                    }
                } else {
                    console.log('Floating widget not available, conversationalWidgets:', conversationalWidgets);
                }
            }, 50);
        }
        
        function hideFloatingWidget() {
            const floatingContainer = document.getElementById('floatingConversational');
            if (floatingContainer) {
                floatingContainer.classList.remove('active');
            }
            
            if (conversationalWidgets['floating'] && conversationalWidgets['floating'].isActive) {
                conversationalWidgets['floating'].deactivate();
            }
        }
        
        function hideLeadMagnet() {
            document.getElementById('popupForm').classList.remove('active');
            document.getElementById('slideBackdrop').classList.remove('active');
            document.getElementById('slidePanel').classList.remove('active');
            
            // Hide floating widget
            hideFloatingWidget();
            
            document.body.style.overflow = '';
        }
        
        function hideAllWidgets() {
            document.getElementById('popupForm').classList.remove('active');
            document.getElementById('slideBackdrop').classList.remove('active');
            document.getElementById('slidePanel').classList.remove('active');
            document.getElementById('embeddedForm').classList.remove('active');
            document.getElementById('floatingButton').classList.remove('active');
            
            // Hide floating widget
            hideFloatingWidget();
            
            document.body.style.overflow = '';
        }
        
        function setConversationalMode(enabled) {
            console.log('setConversationalMode called with:', enabled, 'currentWidget:', currentWidget);
            isConversationalMode = enabled;
            
            // Show/hide appropriate content based on mode
            const conversationalContainers = document.querySelectorAll('.conversational-widget-container');
            const staticForms = document.querySelectorAll('.lead-form');
            
            conversationalContainers.forEach(container => {
                // Don't hide the floating widget container with this logic - it has its own show/hide
                if (container.id !== 'floatingConversational') {
                    container.style.display = enabled ? 'block' : 'none';
                }
            });
            
            staticForms.forEach(form => {
                form.style.display = enabled ? 'none' : 'block';
            });
            
            // If switching to conversational and embedded is active, activate it
            if (enabled && currentWidget === 'embedded') {
                const embeddedWidget = conversationalWidgets[currentWidget];
                if (embeddedWidget && !embeddedWidget.isActive) {
                    embeddedWidget.activate();
                }
            }
            
            // Deactivate all conversational widgets if switching to static
            if (!enabled) {
                Object.values(conversationalWidgets).forEach(widget => {
                    if (widget.isActive) {
                        widget.deactivate();
                    }
                });
            } else {
                // When switching to conversational mode, don't deactivate any currently active widgets
                console.log('Switching to conversational mode - preserving active widgets');
            }
        }
        
        // Close popup when clicking outside
        document.getElementById('popupForm').addEventListener('click', function(e) {
            if (e.target === this) {
                hideLeadMagnet();
            }
        });
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Add animation classes on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-fade-in-up');
                }
            });
        }, observerOptions);
        
        // Observe elements for animation
        document.querySelectorAll('.feature-card, .property-card, .section-header').forEach(el => {
            observer.observe(el);
        });

        // Initialize Conversational Lead Magnet System

        // Create conversational widgets for each form factor
        function initializeConversationalWidgets() {
            const config = {
                industry: 'real-estate',
                businessName: 'ACME Rentals',
                brandColors: {
                    primary: '#1B365D',
                    secondary: '#C69C6C'
                },
                qualificationFlow: 'property-investment',
                valueDelivery: ['roi-calculator', 'property-matching', 'market-insights'],
                primaryCTA: 'book-appointment',
                secondaryCTA: 'request-callback',
                availableCTAs: ['book-appointment', 'request-callback', 'text-updates', 'email-report'],
                integrations: {
                    calendar: 'calendly',
                    webhook: '/api/leads'
                }
            };

            // Create widget instances for each form factor
            conversationalWidgets = {
                popup: new ConversationalWidget({...config, containerId: 'popupConversational', formFactor: 'popup'}),
                'slide-in': new ConversationalWidget({...config, containerId: 'slideConversational', formFactor: 'slide-in'}),
                embedded: new ConversationalWidget({...config, containerId: 'embeddedConversational', formFactor: 'embedded'}),
                floating: new ConversationalWidget({...config, containerId: 'floatingConversational', formFactor: 'floating'})
            };
        }

        // Conversational Widget Class
        class ConversationalWidget {
            constructor(config) {
                this.config = config;
                this.conversation = { step: 0, data: {}, context: {} };
                this.containerId = config.containerId;
                this.formFactor = config.formFactor;
                this.templates = this.getIndustryTemplate();
                this.isActive = false;
            }

            getIndustryTemplate() {
                return {
                    flows: {
                        'property-investment': {
                            steps: [
                                {
                                    id: 'intent',
                                    message: 'Hi! Are you looking to buy, sell, or invest in property? 🏠',
                                    options: ['Buy', 'Sell', 'Invest', 'Just browsing'],
                                    quick: true
                                },
                                {
                                    id: 'budget',
                                    message: 'What\'s your budget range?',
                                    options: ['Under $200K', '$200K-$500K', '$500K-$1M', '$1M+', 'Not sure yet'],
                                    conditional: (data) => data.intent !== 'Just browsing'
                                },
                                {
                                    id: 'timeline',
                                    message: 'When are you looking to make a move?',
                                    options: ['ASAP', 'Next 3 months', '3-6 months', '6+ months', 'Just researching'],
                                    conditional: (data) => data.intent !== 'Just browsing'
                                },
                                {
                                    id: 'location',
                                    message: 'Which area interests you most?',
                                    options: ['Downtown', 'Suburbs', 'Waterfront', 'Business District', 'Historic Area', 'University District']
                                },
                                {
                                    id: 'value-delivery',
                                    message: 'Perfect! Let me show you some insights...',
                                    action: 'showValue'
                                },
                                {
                                    id: 'cta',
                                    message: 'Ready to take the next step?',
                                    action: 'showCTAs'
                                }
                            ]
                        }
                    },
                    valueModules: {
                        'roi-calculator': {
                            title: '📊 ROI Analysis',
                            generate: (data) => {
                                const budget = this.parseBudget(data.budget);
                                const roi = this.calculateROI(budget, data.location);
                                return `Based on your ${data.budget} budget in ${data.location}, here's what I found:<br><br>
                                       💰 Avg. Property Price: $${budget.avg.toLocaleString()}<br>
                                       📈 Expected ROI: ${roi.percentage}% annually<br>
                                       💵 Monthly Cash Flow: $${roi.monthly.toLocaleString()}<br>
                                       🏆 Market Rating: ${roi.rating}/5 stars`;
                            }
                        },
                        'property-matching': {
                            title: '🎯 Perfect Matches',
                            generate: (data) => {
                                const matches = this.findPropertyMatches(data);
                                return `I found ${matches.length} properties that match your criteria:<br><br>` +
                                       matches.map(p => `🏠 ${p.address} - $${p.price.toLocaleString()}<br>
                                                          📍 ${p.neighborhood} • ${p.type}<br>
                                                          ⭐ ${p.score}/100 match score`).join('<br><br>');
                            }
                        },
                        'market-insights': {
                            title: '📈 Market Trends',
                            generate: (data) => {
                                const trends = this.getMarketTrends(data.location);
                                return `Market insights for ${data.location}:<br><br>
                                       📊 Price trend: ${trends.direction} ${trends.percentage}% this year<br>
                                       🏠 Inventory: ${trends.inventory} (${trends.market} market)<br>
                                       📅 Avg. days on market: ${trends.dom} days<br>
                                       🎯 Best time to ${data.intent.toLowerCase()}: ${trends.timing}`;
                            }
                        }
                    },
                    ctas: {
                        'book-appointment': {
                            icon: '📅',
                            text: 'Schedule Property Tour',
                            action: 'calendar',
                            priority: 1
                        },
                        'request-callback': {
                            icon: '☎️',
                            text: 'Request Callback',
                            action: 'callback',
                            priority: 2
                        },
                        'text-updates': {
                            icon: '📱',
                            text: 'Text Me New Listings',
                            action: 'sms-opt-in',
                            priority: 3
                        },
                        'email-report': {
                            icon: '📧',
                            text: 'Email Market Report',
                            action: 'email-delivery',
                            priority: 4
                        }
                    }
                };
            }

            activate() {
                console.log(`Activating widget ${this.formFactor} (${this.containerId})`);
                if (this.isActive) {
                    console.log('Widget already active, returning');
                    return;
                }
                this.isActive = true;
                console.log('About to render widget');
                this.render();
                console.log('About to start conversation');
                this.startConversation();
                console.log('Widget activation complete');
            }

            deactivate() {
                console.log(`Deactivating widget ${this.formFactor} (${this.containerId})`);
                this.isActive = false;
                const container = document.getElementById(this.containerId);
                if (container) {
                    container.innerHTML = '';
                }
            }

            render() {
                const container = document.getElementById(this.containerId);
                console.log(`Rendering widget ${this.formFactor}, container found:`, !!container);
                if (!container) {
                    console.log(`Container ${this.containerId} not found!`);
                    return;
                }

                // Add close button for floating widgets
                const closeButton = this.formFactor === 'floating' ? 
                    '<button class="chat-close" onclick="hideLeadMagnet()">&times;</button>' : '';
                
                container.innerHTML = `
                    <div class="chat-widget ${this.formFactor}" id="${this.containerId}-chat">
                        <div class="chat-header">
                            <div class="agent-avatar">🏠</div>
                            <div class="agent-info">
                                <h4>${this.config.businessName} Assistant</h4>
                                <p>Here to help you find the perfect property</p>
                            </div>
                            ${closeButton}
                        </div>
                        <div class="chat-messages" id="${this.containerId}-messages">
                            <div class="message agent">
                                <div class="message-avatar">🏠</div>
                                <div class="message-bubble">
                                    Welcome! I'm here to help you find the perfect property. How can I assist you today?
                                </div>
                            </div>
                        </div>
                        <div class="chat-input-area" id="${this.containerId}-input">
                            <!-- Dynamic input will be inserted here -->
                        </div>
                    </div>
                `;

                // Add styles for this specific form factor
                this.addStyles();
            }

            addStyles() {
                if (document.getElementById(`conversational-styles-${this.formFactor}`)) return;

                const styles = document.createElement('style');
                styles.id = `conversational-styles-${this.formFactor}`;
                styles.textContent = this.getFormFactorStyles();
                document.head.appendChild(styles);
            }

            getFormFactorStyles() {
                const baseStyles = `
                    .chat-widget {
                        background: white;
                        border-radius: 20px;
                        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
                        overflow: hidden;
                        font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', Roboto, sans-serif;
                        display: flex;
                        flex-direction: column;
                        height: 100%;
                        max-height: 600px;
                    }
                    
                    .chat-header {
                        background: linear-gradient(135deg, ${this.config.brandColors.primary} 0%, ${this.config.brandColors.secondary} 100%);
                        color: white;
                        padding: 16px 20px;
                        display: flex;
                        align-items: center;
                        gap: 12px;
                        position: relative;
                    }
                    
                    .chat-close {
                        position: absolute;
                        top: 16px;
                        right: 16px;
                        background: rgba(255, 255, 255, 0.2);
                        color: white;
                        border: none;
                        width: 32px;
                        height: 32px;
                        border-radius: 50%;
                        cursor: pointer;
                        font-size: 18px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: background 0.2s ease;
                    }
                    
                    .chat-close:hover {
                        background: rgba(255, 255, 255, 0.3);
                    }
                    
                    .agent-avatar {
                        width: 36px;
                        height: 36px;
                        border-radius: 50%;
                        background: rgba(255, 255, 255, 0.2);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 18px;
                        border: 2px solid rgba(255, 255, 255, 0.3);
                    }
                    
                    .agent-info h4 {
                        margin: 0;
                        font-size: 16px;
                        font-weight: 600;
                        color: #ffffff;
                        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
                    }
                    
                    .agent-info p {
                        margin: 2px 0 0;
                        font-size: 13px;
                        color: rgba(255, 255, 255, 0.95);
                        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
                    }
                    
                    .chat-messages {
                        flex: 1;
                        padding: 16px;
                        overflow-y: auto;
                        display: flex;
                        flex-direction: column;
                        gap: 12px;
                        min-height: 300px;
                        max-height: 400px;
                        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                    }
                    
                    .message {
                        display: flex;
                        align-items: flex-start;
                        gap: 10px;
                        max-width: 85%;
                        animation: messageSlideIn 0.3s ease-out;
                    }
                    
                    .message.user {
                        align-self: flex-end;
                        flex-direction: row-reverse;
                    }
                    
                    .message-avatar {
                        width: 32px;
                        height: 32px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 14px;
                        font-weight: 600;
                        flex-shrink: 0;
                    }
                    
                    .message.agent .message-avatar {
                        background: linear-gradient(135deg, ${this.config.brandColors.primary} 0%, ${this.config.brandColors.secondary} 100%);
                        color: white;
                    }
                    
                    .message.user .message-avatar {
                        background: #e2e8f0;
                        color: #475569;
                    }
                    
                    .message-bubble {
                        padding: 12px 16px;
                        border-radius: 18px;
                        font-size: 15px;
                        line-height: 1.4;
                        position: relative;
                        word-break: break-word;
                    }
                    
                    .message.agent .message-bubble {
                        background: white;
                        color: #475569;
                        border-bottom-left-radius: 4px;
                        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
                    }
                    
                    .message.user .message-bubble {
                        background: linear-gradient(135deg, ${this.config.brandColors.primary} 0%, ${this.config.brandColors.secondary} 100%);
                        color: white;
                        border-bottom-right-radius: 4px;
                    }
                    
                    .chat-input-area {
                        padding: 20px;
                        border-top: 1px solid #e9ecef;
                        background: #f8f9fa;
                    }
                    
                    .chat-options {
                        display: flex;
                        flex-direction: column;
                        gap: 8px;
                    }
                    
                    .chat-option {
                        background: white;
                        border: 2px solid #e9ecef;
                        padding: 12px 16px;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        text-align: center;
                        font-weight: 500;
                    }
                    
                    .chat-option:hover {
                        border-color: ${this.config.brandColors.secondary};
                        background: ${this.config.brandColors.secondary}15;
                    }
                    
                    .chat-text-input {
                        width: 100%;
                        padding: 12px 16px;
                        border: 2px solid #e9ecef;
                        border-radius: 12px;
                        font-size: 14px;
                        transition: border-color 0.2s ease;
                        margin-bottom: 12px;
                        font-family: 'Inter', sans-serif;
                    }
                    
                    .chat-text-input:focus {
                        outline: none;
                        border-color: ${this.config.brandColors.secondary};
                    }
                    
                    .chat-submit {
                        background: ${this.config.brandColors.primary};
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 12px;
                        cursor: pointer;
                        font-weight: 600;
                        width: 100%;
                        transition: all 0.2s ease;
                        font-family: 'Inter', sans-serif;
                    }
                    
                    .chat-submit:hover {
                        background: ${this.config.brandColors.secondary};
                    }
                    
                    .chat-value-display {
                        background: white;
                        border: 2px solid ${this.config.brandColors.secondary};
                        border-radius: 12px;
                        padding: 16px;
                        margin: 12px 0;
                    }
                    
                    .chat-value-title {
                        font-weight: 600;
                        color: ${this.config.brandColors.primary};
                        margin-bottom: 8px;
                    }
                    
                    .chat-cta-options {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 8px;
                        margin-top: 16px;
                    }
                    
                    .chat-cta {
                        background: white;
                        border: 2px solid ${this.config.brandColors.primary};
                        color: ${this.config.brandColors.primary};
                        padding: 12px 8px;
                        border-radius: 12px;
                        cursor: pointer;
                        text-align: center;
                        font-weight: 600;
                        font-size: 12px;
                        transition: all 0.2s ease;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 4px;
                    }
                    
                    .chat-cta:hover {
                        background: ${this.config.brandColors.primary};
                        color: white;
                    }
                    
                    .chat-cta.primary {
                        background: ${this.config.brandColors.primary};
                        color: white;
                        grid-column: 1 / -1;
                    }
                    
                    @keyframes messageSlideIn {
                        from {
                            opacity: 0;
                            transform: translateX(20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateX(0);
                        }
                    }
                `;

                // Form factor specific adjustments
                if (this.formFactor === 'embedded') {
                    return baseStyles + `
                        .chat-widget {
                            min-height: 650px;
                            width: 100%;
                            max-width: 900px;
                        }
                        .chat-messages {
                            min-height: 350px;
                            max-height: 400px;
                        }
                    `;
                } else if (this.formFactor === 'slide-in') {
                    return baseStyles + `
                        .chat-widget {
                            height: 100vh;
                            width: 50vw;
                            min-width: 400px;
                            border-radius: 0;
                        }
                        .chat-messages {
                            min-height: 400px;
                            max-height: calc(100vh - 200px);
                        }
                    `;
                } else if (this.formFactor === 'popup') {
                    return baseStyles + `
                        .chat-widget {
                            width: 600px;
                            max-width: 90vw;
                            height: 700px;
                            max-height: 85vh;
                        }
                        .chat-messages {
                            min-height: 400px;
                            max-height: calc(85vh - 200px);
                        }
                    `;
                } else if (this.formFactor === 'floating') {
                    return baseStyles + `
                        .floating-widget-container {
                            position: fixed;
                            bottom: 80px;
                            right: 20px;
                            z-index: 10000;
                            display: none;
                        }
                        .floating-widget-container.active {
                            display: block;
                        }
                        .chat-widget {
                            width: 380px;
                            height: 500px;
                            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
                            animation: slideInUp 0.3s ease-out;
                        }
                        .chat-messages {
                            min-height: 300px;
                            max-height: 350px;
                        }
                        @keyframes slideInUp {
                            from {
                                opacity: 0;
                                transform: translateY(20px) scale(0.95);
                            }
                            to {
                                opacity: 1;
                                transform: translateY(0) scale(1);
                            }
                        }
                        @media (max-width: 480px) {
                            .floating-widget-container {
                                right: 10px;
                                left: 10px;
                            }
                            .chat-widget {
                                width: calc(100vw - 20px);
                            }
                        }
                    `;
                }

                return baseStyles;
            }

            startConversation() {
                const flow = this.templates.flows[this.config.qualificationFlow];
                if (flow && flow.steps.length > 0) {
                    setTimeout(() => this.showStep(flow.steps[0]), 500);
                }
            }

            showStep(step) {
                if (step.conditional && !step.conditional(this.conversation.data)) {
                    this.nextStep();
                    return;
                }
                
                this.addBotMessage(step.message);
                
                if (step.action) {
                    this.executeAction(step.action);
                } else if (step.options) {
                    this.showOptions(step.options, step.id);
                } else if (step.input) {
                    this.showInput(step.input, step.id, step.placeholder);
                }
            }

            showOptions(options, stepId) {
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (!inputArea) return;
                
                inputArea.innerHTML = `
                    <div class="chat-options">
                        ${options.map(option => `
                            <div class="chat-option" data-value="${option}" data-step="${stepId}">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                `;
                
                inputArea.querySelectorAll('.chat-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const value = e.target.dataset.value;
                        const step = e.target.dataset.step;
                        this.handleUserResponse(value, step);
                    });
                });
            }

            showInput(inputType, stepId, placeholder = '') {
                // Text input is no longer supported - this should not be called
                // All interactions should use options instead
                console.warn('Text input is not supported in choices-only mode. Use options instead.');
                this.nextStep();
            }

            handleUserResponse(value, stepId) {
                this.addUserMessage(value);
                this.conversation.data[stepId] = value;
                
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (inputArea) inputArea.innerHTML = '';
                
                setTimeout(() => this.nextStep(), 500);
            }

            nextStep() {
                this.conversation.step++;
                const flow = this.templates.flows[this.config.qualificationFlow];
                
                if (this.conversation.step < flow.steps.length) {
                    setTimeout(() => {
                        this.showStep(flow.steps[this.conversation.step]);
                    }, 1000);
                }
            }

            executeAction(action) {
                switch(action) {
                    case 'showValue':
                        this.showValueDelivery();
                        break;
                    case 'showCTAs':
                        this.showCTAOptions();
                        break;
                }
            }

            showValueDelivery() {
                const modules = this.config.valueDelivery;
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (!inputArea) return;
                
                let content = '';
                modules.forEach(moduleId => {
                    if (this.templates.valueModules[moduleId]) {
                        const module = this.templates.valueModules[moduleId];
                        const value = module.generate.call(this, this.conversation.data);
                        content += `
                            <div class="chat-value-display">
                                <div class="chat-value-title">${module.title}</div>
                                <div>${value}</div>
                            </div>
                        `;
                    }
                });
                
                inputArea.innerHTML = content;
                
                setTimeout(() => this.nextStep(), 3000);
            }

            showCTAOptions() {
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (!inputArea) return;
                
                const ctas = this.templates.ctas;
                const availableCTAs = this.config.availableCTAs;
                
                let ctaHTML = '<div class="chat-cta-options">';
                
                // Primary CTA
                const primaryCTA = ctas[this.config.primaryCTA];
                if (primaryCTA) {
                    ctaHTML += `
                        <div class="chat-cta primary" data-action="${this.config.primaryCTA}">
                            <span>${primaryCTA.icon}</span>
                            <span>${primaryCTA.text}</span>
                        </div>
                    `;
                }
                
                // Secondary CTAs
                availableCTAs.forEach(ctaId => {
                    if (ctaId !== this.config.primaryCTA && ctas[ctaId]) {
                        const cta = ctas[ctaId];
                        ctaHTML += `
                            <div class="chat-cta" data-action="${ctaId}">
                                <span>${cta.icon}</span>
                                <span>${cta.text}</span>
                            </div>
                        `;
                    }
                });
                
                ctaHTML += '</div>';
                inputArea.innerHTML = ctaHTML;
                
                // Bind CTA events
                inputArea.querySelectorAll('.chat-cta').forEach(cta => {
                    cta.addEventListener('click', (e) => {
                        const action = e.target.closest('.chat-cta').dataset.action;
                        this.executeCTA(action);
                    });
                });
            }

            executeCTA(action) {
                switch(action) {
                    case 'book-appointment':
                        this.addBotMessage('Perfect! Opening our calendar... 📅');
                        setTimeout(() => {
                            window.open('https://calendly.com/acme-rentals', '_blank');
                        }, 1000);
                        break;
                        
                    case 'request-callback':
                        this.collectCallbackInfo();
                        break;
                        
                    case 'text-updates':
                        this.collectPhoneNumber();
                        break;
                        
                    case 'email-report':
                        this.collectEmailAddress();
                        break;
                }
            }

            collectCallbackInfo() {
                this.addBotMessage('I\'ll have one of our agents call you. When would be the best time?');
                
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (!inputArea) return;
                
                inputArea.innerHTML = `
                    <div class="chat-options">
                        <div class="chat-option" data-value="This morning" data-action="callback-time">This morning</div>
                        <div class="chat-option" data-value="This afternoon" data-action="callback-time">This afternoon</div>
                        <div class="chat-option" data-value="This evening" data-action="callback-time">This evening</div>
                        <div class="chat-option" data-value="Tomorrow" data-action="callback-time">Tomorrow</div>
                    </div>
                `;
                
                inputArea.querySelectorAll('.chat-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const time = e.target.dataset.value;
                        this.addUserMessage(time);
                        this.addBotMessage('Perfect! We\'ll call you ' + time.toLowerCase() + '. Thanks for your interest! 📞');
                        this.trackConversion('callback-requested', { preferredTime: time, data: this.conversation.data });
                        inputArea.innerHTML = '';
                    });
                });
            }

            collectPhoneNumber() {
                this.addBotMessage('I\'ll send you our best listings! How often would you like updates?');
                
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (!inputArea) return;
                
                inputArea.innerHTML = `
                    <div class="chat-options">
                        <div class="chat-option" data-value="Daily updates" data-action="sms-frequency">Daily updates</div>
                        <div class="chat-option" data-value="Weekly digest" data-action="sms-frequency">Weekly digest</div>
                        <div class="chat-option" data-value="New listings only" data-action="sms-frequency">New listings only</div>
                        <div class="chat-option" data-value="Price drops" data-action="sms-frequency">Price drops</div>
                    </div>
                `;
                
                inputArea.querySelectorAll('.chat-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const frequency = e.target.dataset.value;
                        this.addUserMessage(frequency);
                        this.addBotMessage('Perfect! You\'ll get ' + frequency.toLowerCase() + ' via text. Welcome to the VIP list! 📱');
                        this.trackConversion('sms-opt-in', { frequency, data: this.conversation.data });
                        inputArea.innerHTML = '';
                    });
                });
            }

            collectEmailAddress() {
                this.addBotMessage('I\'ll email you a detailed market report! What type of report interests you most?');
                
                const inputArea = document.getElementById(`${this.containerId}-input`);
                if (!inputArea) return;
                
                inputArea.innerHTML = `
                    <div class="chat-options">
                        <div class="chat-option" data-value="Market trends report" data-action="report-type">Market trends report</div>
                        <div class="chat-option" data-value="Investment guide" data-action="report-type">Investment guide</div>
                        <div class="chat-option" data-value="Neighborhood analysis" data-action="report-type">Neighborhood analysis</div>
                        <div class="chat-option" data-value="Buyer's checklist" data-action="report-type">Buyer's checklist</div>
                    </div>
                `;
                
                inputArea.querySelectorAll('.chat-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const reportType = e.target.dataset.value;
                        this.addUserMessage(reportType);
                        this.addBotMessage('Excellent! Your ' + reportType.toLowerCase() + ' will be ready shortly. Check your inbox in the next few minutes! 📧');
                        this.trackConversion('email-report', { reportType, data: this.conversation.data });
                        inputArea.innerHTML = '';
                    });
                });
            }

            addBotMessage(message) {
                const messagesContainer = document.getElementById(`${this.containerId}-messages`);
                if (!messagesContainer) return;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message agent';
                messageDiv.innerHTML = `
                    <div class="message-avatar">🏠</div>
                    <div class="message-bubble">${message}</div>
                `;
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            addUserMessage(message) {
                const messagesContainer = document.getElementById(`${this.containerId}-messages`);
                if (!messagesContainer) return;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user';
                messageDiv.innerHTML = `
                    <div class="message-avatar">👤</div>
                    <div class="message-bubble">${message}</div>
                `;
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            // Helper methods for value delivery
            parseBudget(budgetStr) {
                const budgetMap = {
                    'Under $200K': { min: 0, max: 200000, avg: 150000 },
                    '$200K-$500K': { min: 200000, max: 500000, avg: 350000 },
                    '$500K-$1M': { min: 500000, max: 1000000, avg: 750000 },
                    '$1M+': { min: 1000000, max: 5000000, avg: 2000000 },
                    'Not sure yet': { min: 0, max: 1000000, avg: 400000 }
                };
                return budgetMap[budgetStr] || budgetMap['Not sure yet'];
            }
            
            calculateROI(budget, location) {
                const baseROI = 8.5;
                const locationMultiplier = location && location.toLowerCase().includes('downtown') ? 1.2 : 1.0;
                const budgetMultiplier = budget.avg > 500000 ? 0.9 : 1.1;
                
                const roi = baseROI * locationMultiplier * budgetMultiplier;
                const monthlyReturn = (budget.avg * (roi / 100)) / 12;
                
                return {
                    percentage: roi.toFixed(1),
                    monthly: Math.round(monthlyReturn),
                    rating: Math.min(5, Math.round(roi / 2))
                };
            }
            
            findPropertyMatches(data) {
                const mockProperties = [
                    {
                        address: '123 Main Street',
                        price: 450000,
                        neighborhood: data.location || 'Downtown',
                        type: 'Condo',
                        score: 95
                    },
                    {
                        address: '456 Oak Avenue',
                        price: 380000,
                        neighborhood: data.location || 'Suburbs',
                        type: 'Townhouse',
                        score: 88
                    },
                    {
                        address: '789 Pine Street',
                        price: 520000,
                        neighborhood: data.location || 'Waterfront',
                        type: 'Single Family',
                        score: 92
                    }
                ];
                
                return mockProperties.slice(0, 3);
            }
            
            getMarketTrends(location) {
                return {
                    direction: 'Up',
                    percentage: '12.5',
                    inventory: '2.1 months',
                    market: 'seller\'s',
                    dom: 18,
                    timing: 'Spring (March-May)'
                };
            }
            
            trackConversion(event, data) {
                console.log('Conversion tracked:', event, data);
                
                if (this.config.integrations.webhook) {
                    fetch(this.config.integrations.webhook, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            event,
                            data,
                            timestamp: Date.now(),
                            source: 'conversational-lead-magnet-demo',
                            formFactor: this.formFactor
                        })
                    });
                }
            }
        }
    </script>
</body>
</html>